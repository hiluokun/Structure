# 批量生成转角双层石墨烯结构脚本

## 概述
本仓库包含一个 Python 脚本，用于批量生成转角双层石墨烯（Twisted Bilayer Graphene, TBG）的结构文件。脚本通过枚举不同的 SL1 参数（整数对 (m, n)），自动计算对应的转角以及 Moiré 超胞内的原子数，再根据用户设定的条件（例如最大原子数、层间距、晶胞高度等）筛选出符合条件的结构，并生成对应的 xyz 文件。生成的结构具有自定义的层间距和居中于晶胞中的石墨烯层，非常适合后续的结构优化和物理性质计算。

## 物理背景与方法
转角双层石墨烯由两个具有一定旋转角度的石墨烯层构成。具体构造方法如下：
- **SL1 参数**：由整数对 (m, n) 定义，决定最小 Moiré 超胞的构型。
- **SL2 参数**：自动计算为 (-n, m+n)。
- **转角计算公式**：  
  \[
  \cos\theta = \frac{m^2 + 4\, m\, n + n^2}{2\,(m^2 + m\, n + n^2)}
  \]
- **理论原子数**：对于双层石墨烯，Moiré 单元内的理论原子数为  
  \[
  N = 4\,\left(m^2 + m\,n + n^2\right)
  \]
  
通过修改脚本中的参数，可以控制生成结构的层间距、晶胞高度（用于提供足够的真空）以及筛选出的 SL1 构型（例如仅生成原子数不超过 120 的结构）。

## 依赖环境
该脚本依赖于以下 Python 库：
- [numpy](https://numpy.org/)
- [ASE (Atomic Simulation Environment)](https://wiki.fysik.dtu.dk/ase/)

安装依赖：
```bash
pip install numpy ase 


脚本参数说明
t_z：层间距，脚本中设定为 3.4 Å。

cell_height：晶胞在 z 方向的长度，设定为 15 Å，用于提供真空层。

居中层：通过计算晶胞中心 (z_center = cell_height/2) 将第一层放在 z = z_center - t_z/2，第二层放在 z = z_center + t_z/2。

max_atoms：Moiré 超胞内理论原子数的上限（按照公式转角计算公式计算），默认设为 120。

角度范围：可根据需要设定转角的允许范围（脚本中设定为 0 到 90∘）。

使用方法
克隆本仓库或下载脚本文件（例如 generate_TBG.py）。

根据需求修改脚本中的参数设置，例如 t_z、cell_height、max_atoms 和角度范围。

运行脚本：

bash
复制
python generate_TBG.py
脚本将输出符合条件的 SL1 参数信息，并在当前目录下生成多个 xyz 文件，文件名中包含了 SL1、SL2 参数、转角（单位为度）以及理论原子数信息。

输出示例
例如：

SL1 = (1, 2) 对应的转角约为 21.79°，理论原子数为 28；

SL1 = (2, 4) 虽然转角相同（21.79°），但理论原子数为 112。
这说明相同转角下，通过不同的整数倍关系可以得到尺寸不同的 Moiré 超胞。


